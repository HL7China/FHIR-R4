<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
<head>
    <title>FHIR本地化 - HL7 FHIR 中国</title>

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="author" content="http://hl7.org/fhir"/>

  <link rel="stylesheet" href="fhir.css"/>
  <link rel="Prev" href="http://hl7.org/fhir/profiling.html"/>

    <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="./dist/css/bootstrap.css"/>
  <link rel="stylesheet" href="./assets/css/bootstrap-fhir.css"/>

    <!-- Project extras -->
  <link rel="stylesheet" href="./assets/css/project.css"/>
  <link rel="stylesheet" href="./assets/css/pygments-manni.css"/>
	<link rel="stylesheet" href="jquery-ui.css"/>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- [if lt IE 9]>
  <script src="./assets/js/html5shiv.js"></script>
  <script src="./assets/js/respond.min.js"></script>
  <![endif] -->

    <!-- Favicons -->
  <link sizes="144x144" rel="apple-touch-icon-precomposed" href="./assets/ico/apple-touch-icon-144-precomposed.png"/>
  <link sizes="114x114" rel="apple-touch-icon-precomposed" href="./assets/ico/apple-touch-icon-114-precomposed.png"/>
  <link sizes="72x72" rel="apple-touch-icon-precomposed" href="./assets/ico/apple-touch-icon-72-precomposed.png"/>
  <link rel="apple-touch-icon-precomposed" href="./assets/ico/apple-touch-icon-57-precomposed.png"/>
  <link rel="shortcut icon" href="./assets/ico/favicon.png"/>

</head>
<body>
    <div id="segment-header" class="segment"></div>  <!-- /segment-header -->	


	<div id="segment-navbar" class="segment">  <!-- segment-navbar -->
		<div id="stripe"> </div>
		<div class="container">  <!-- container -->
   <!-- HEADER CONTENT -->
 	      		 	      		      		
			<nav class="navbar navbar-inverse">
				<div class="container">
					<button data-target=".navbar-inverse-collapse" data-toggle="collapse" type="button" class="navbar-toggle">
						<span class="icon-bar"> </span>
						<span class="icon-bar"> </span>
						<span class="icon-bar"> </span>
					</button>
					<a href="index.html" class="navbar-brand hidden">FHIR</a>
					
    <div class="nav-collapse collapse navbar-inverse-collapse"  id="nav-content"></div>  <!-- /.nav-collapse -->
				</div>  <!-- /.container -->
			</nav>  <!-- /.navbar -->
      		
  <!-- /HEADER CONTENT -->				
		</div>  <!-- /container -->
	</div>  <!-- /segment-navbar -->
	

	<div id="segment-breadcrumb" class="segment">  <!-- segment-breadcrumb -->
		<div class="container">  <!-- container -->	
			<ul class="breadcrumb">
        <li><img src="conformance.jpg"/><b> 当前位置：</b><a href="conformance-module.html"> 符合性</a></li>
        <li>配置FHIR</li>      <!-- profiling.html / page / -->
        <div class="breadcrumbRight">
            <ul>
                <li>
                    <a href="http://hl7.org/fhir/profiling.html" target="_blank" title="英语官方页面">
                        切换到英文
                    </a>
                    Limitations of Use
            </ul>

        </div>
			</ul>	
		</div>  <!-- /container -->
	</div>  <!-- /segment-breadcrumb -->
	

	<div id="segment-content" class="segment">  <!-- segment-content -->
	<div class="container">  <!-- container -->
            <div class="row">
            	<div class="inner-wrapper">
  <!-- CONTENT CONTENT -->


<div class="col-12">

<ul class="nav nav-tabs"><li class="active"><a href="#">Profiling FHIR</a></li><li><a href="profiling-examples.html">Examples</a></li></ul>


<h2 class="self-link-parent"><span class="sectioncount">5.1.0<a name="5.1.0"> </a></span> Profiling FHIR <a href="profiling.html#5.1.0" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h2>
<table class="colsn"><tr><td id="wg">工作组: <a href="http://www.hl7.org/Special/committees/fiwg/index.cfm" _target="blank">FHIR Infrastructure <img src="external.png" style="text-align: baseline"/></a></td><td id="fmm"><a href="versions.html#maturity">成熟度</a>: Normative</td><td id="ballot"><a href="versions.html#std-process">标准状态</a>:  <!-- !ns! --><a href="versions.html#std-process">Normative</a></td></tr></table>


<p>
The base FHIR specification (this specification) describes a set of base resources, frameworks
and APIs that are used in many different contexts in healthcare. However, there is wide variability
between jurisdictions and across the healthcare ecosystem around
practices, requirements, regulations, education and what actions are feasible
and/or beneficial.
</p>
<p>
For this reason, the FHIR specification is a "platform specification" - it creates
a common platform or foundation on which a variety of different solutions are implemented.
As a consequence, this specification usually requires further adaptation to particular
contexts of use. Typically, these adaptations specify:
</p>
<ul>
 <li>Rules about which resource elements are or are not used, and what additional elements are added that are not part of the base specification</li>
 <li>Rules about which API features are used, and how</li>
 <li>Rules about which terminologies are used in particular elements</li>
 <li>Descriptions of how the Resource elements and API features map to local requirements and/or implementations</li>
</ul>
<p>
Note that because of the nature of the healthcare ecosystem, there may be multiple
overlapping sets of adaptations - by healthcare domain, by country, by institution, and/or by vendor/implementation.
</p>
<a name="glossary"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.1</span> Glossary <a href="profiling.html#glossary" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>
<p>
FHIR defines a cascade of artifacts for this purpose:
</p>
<table class="grid">
 <tr>
  <td><b>Artifact</b></td>
  <td><b>Description</b></td>
  <td><b><a href="http://hl7.org/fhir/us/core">US Core <img src="external.png" style="text-align: baseline"/></a> example</b></td>
 </tr>
 <tr>
  <td>Implementation Guide (IG)</td>
  <td>A coherent and bounded set of adaptations that are published as a single unit. Validation occurs within the context of the Implementation Guide</td>
  <td><a href="http://hl7.org/fhir/us/core">US Core IG <img src="external.png" style="text-align: baseline"/></a></td>
 </tr>
 <tr>
  <td>Package</td>
  <td>A group of related adaptations that are published as a group within an Implementation Guide</td>
  <td><a href="http://hl7.org/fhir/us/core/capstmnts.html">US Core Capability Statements <img src="external.png" style="text-align: baseline"/></a></td>
 </tr>
 <tr>
  <td>Conformance Resource</td>
  <td>A single resource in a package that makes rules about how an implementation works. These are described below</td>
   <td><a href="http://hl7.org/fhir/us/core/ValueSet-us-core-problem.html">DAF Problem Value Set <img src="external.png" style="text-align: baseline"/></a></td>
 </tr>
 <tr>
  <td>Profile</td>
  <td>A set of constraints on a resource represented as a structure definition with kind = <code>constraint</code></td>
   <td><a href="http://hl7.org/fhir/us/core/StructureDefinition-us-core-medicationrequest.html">DAF Medication Request <img src="external.png" style="text-align: baseline"/></a></td>
 </tr>
</table>
<p>
The verb 'profile', or 'profiling', is used to describe the process of creating a profile.
</p>

<a name="conf-res"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.2</span> Conformance Resources <a href="profiling.html#conf-res" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>

<p>
Typically, Implementation Guides both restrict and extend APIs, resources and terminologies. FHIR provides a set of resources that
can be used to represent and share the decisions that have been made, and allows implementers to build useful services from them. These
resources are known as the conformance resources. These conformance resources allow implementers to:
</p>
<ul>
 <li>Indicate that <a href="http.html">some API calls</a> are not used for a particular situation, and provide additional details about how API calls are used (<a href="capabilitystatement.html">Capability Statement</a>)</li>
 <li>Add additional <a href="operations.html">operations</a> or <a href="search.html">search parameters</a> not in the base specification
   (using the <a href="operationdefinition.html">OperationDefinition</a> resource or the <a href="searchparameter.html">SearchParameter</a> Resource)</li>
 <li>Define how a particular structure (Resource, Extension or Data Type) is used (<a href="structuredefinition.html">StructureDefinition</a> Resource):
    <ul>
      <li>Describe how existing elements in resources are used</li>
      <li>Identify existing elements that are not used</li>
      <li>Define extensions that can be used in resources or data types</li>
    </ul>
 </li>
 <li>Mix custom and standard terminologies and choose which codes from these to use for a particular coded element(<a href="valueset.html">Value Set</a> and StructureDefinition Resources)</li>
 <li>Map between local and standard terminologies or content models (<a href="conceptmap.html">Concept Map</a> Resource)</li>
 <li>Register system namespaces for identifiers and terminologies (<a href="namingsystem.html">NamingSystem</a> Resource)</li>
</ul>
<p>
These resources need to be used as discussed below, and also
following the basic concepts for extension that are described in <a href="extensibility.html">"Extensibility"</a>.
For implementer convenience, the specification itself publishes its base definitions using these same resources.
</p>

<a name="profile-uses"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.3</span> Two uses of Profiles <a href="profiling.html#profile-uses" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>
<p>
The <a href="capabilitystatement.html">CapabilityStatement</a> resource describes two different uses for profiles on resources:
Resource Profiles and Supported Profiles. Resource Profiles are specified using the <i>CapabilityStatement.rest.resource.profile</i> element
and Supported Profiles are specified using the <i>CapabilityStatement.rest.resource.supportedProfile</i> element.
</p>
<a name="CapabilityStatement.rest.resource.profile"></a>
<h4 class="self-link-parent"><span class="sectioncount">5.1.0.3.1</span> CapabilityStatement.rest.resource.profile <a href="profiling.html#CapabilityStatement.rest.resource.profile" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h4>
<p>
These profiles describe the general features that are supported by the system for each kind of
resource. Typically, this is the superset of all the different use-cases implemented by the system.
This is a resource-level perspective of a system's functionality.
</p>
<a name="CapabilityStatement.rest.resource.supportedProfile"></a>
<h4 class="self-link-parent"><span class="sectioncount">5.1.0.3.2</span> CapabilityStatement.rest.resource.supportedProfile <a href="profiling.html#CapabilityStatement.rest.resource.supportedProfile" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h4>
<p>
These profiles describe the information handled/produced by the system on a per use case basis.
Some examples of the uses for these kind of profiles:
</p>
<ul>
 <li>A Laboratory service producing a set of different reports - general chemistry, blood count, etc. Typical labs would support several hundred different reports</li>
 <li>A care manager which handles a set of different types of care plans and associated clinical resources</li>
 <li>A medications formulary that handles several different levels of sophistication in its medication representations</li>
</ul>
<p>
These profiles represent different use cases leading to handling resources of the type indicated by the CapabilityStatement.rest.resource.type differently. For instance:
</p>
<ul>
 <li>A decision support service that provides analysis on several different sets of data conforming to a particular pattern - tests x,y and z with particular codes and units</li>
</ul>
<p>
For a producer system and a consumer system to exchange data successfully based on
one of these supported profiles, it is not enough to know that the
systems happen to have profiles that overlap for the use case
of interest; the consumer must be able to filter the total set of resources
made available by the producer system and deal only with the ones relevant
to the use case.
</p>
<p>
As an example, consider a laboratory system generating thousands of reports
a day. 1% of those reports are a particular endocrine report that a
decision support system knows how to process. Both systems declare that
they support the particular endocrine report profile, but how does the decision support
system actually find the endocrine reports that it knows how to process?
</p>
<p>
One possible option is for the decision support system to receive every single
report coming from the lab system, check whether it conforms to the
profile or not, and then decide whether to process it. Checking whether
a resource conforms to a particular profile or not is a straight
forward operation (one option is to use the <a href="downloads.html">provided tools for this</a>),
but this is a very inefficient way - the decision support system has to receive
and process 100 times as many resources as it uses. To help a consumer
find the correct set of reports for a use-case, a producer of
resources also SHALL, for any profile declared in <code>CapabilityStatement.rest.resource.supportedProfile</code>:
</p>
<ol>
 <li><a href="resource.html#meta">Mark resources</a> with profile assertions documenting the profile(s) they conform to (this enables indexing by the profile)</li>
 <li>(if a server) support searching by the <a href="search.html#profile">_profile parameter</a> for the declared profiles</li>
</ol>
<p>
Beyond these requirements, a producer of resources SHOULD ensure that any resource instance that would reasonably be expected
to conform to the declared profiles SHOULD be published in this form.
</p>

<blockquote class="stu-note"><p><b>Trial-Use Note:</b>
<a name="dstu"></a>
There are many uninvestigated issues associated with this use of profiles.
HL7 is actively seeking feedback from users who experiment in this area, and users
should be prepared for changes to features and obligations in this area in the future.
</p>
<p>
Feedback is welcome <a href="http://hl7.org/fhir-issues">here <img src="external.png" style="text-align: baseline"/></a>.
</p></blockquote>

<a name="api"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.4</span> Extending and Restricting the API <a href="profiling.html#api" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>
<p>
A CapabilityStatement resource lists the REST interactions (read, update, search, etc.) that a server provides or that a client uses, along with
some supporting information for each. It can also be used to define a set of desired behaviors (e.g. as part of a specification or
a Request for Proposal).  The only interaction that servers are required to support is the <a href="http.html#capabilities">capabilities</a>
interaction itself - to retrieve the server's CapabilityStatement. Beyond that, servers and clients support and use whichever
API calls are relevant to their use case.
</p>
<p>
In addition to the operations that FHIR provides, servers may provide additional
operations that are not part of the FHIR specification. Implementers can safely do this
by appending a custom operation name prefixed with '$' to an existing FHIR URL, as the <a href="operations.html">Operations
framework</a> does. The Conformance resource supports defining what OperationDefinitions make use of particular
names on an end-point.  If services are defined that are not declared using OperationDefinition, it may be
appropriate to use longer names, reducing the chance of collision (and confusion) with services declared by
other interfaces.  The base specification will never define operation names with a "." (period) in them, so
implementers are recommended to use some appropriate prefix in their names (such as "ihe.someService")
to reduce the likelihood of name conflicts.
</p>
<p>
Implementations are encouraged, but not required, to define operations using the standard
FHIR operations framework - that is, to declare the operations using the OperationDefinition
resource, but some operations may involve formats that can't be described that way.
</p>
<p>
Implementations are also able to extend the FHIR API using additional content types.
For instance, it might be useful to <a href="http.html#read">read</a> or <a href="http.html#update">update</a>
the appointment resources using a vCard based format. vCard defines its own mime type, and these additional mime types can
safely be used in addition to those defined in this specification.
</p>

<a name="resources"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.5</span> Extending and Restricting Resources <a href="profiling.html#resources" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>

<p>
Extending and restricting resources (collectively known as 'profiling a resource') is done with a
"StructureDefinition" resource, which is a statement of rules about
how the elements in a resource are used, and where extensions are used in a resource.
</p>

<a name="cardinality"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.6</span> Changing Cardinality <a href="profiling.html#cardinality" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>

<p>
One key function of profiles is to change the cardinality of an element. A profile
can restrict the cardinality of an element within the limits of the base structure
it is constraining. This table summarizes what types of restrictions are allowed:
</p>
<table class="grid">
 <tr><td>derived (across)<br/>base (down)</td>       <td>0..0<br/>(Not used)</td>      <td>0..1<br/>(optional)</td>              <td>0..n<br/>(optional, many)</td>      <td>1..1<br/>(required)</td>     <td>1..n<br/>(at least 1)</td>    </tr>
 <tr><td>0..1</td>   <td>yes</td>                     <td>yes</td>                             <td>no</td>                            <td>yes</td>                    <td>no</td>                      </tr>
 <tr><td>0..*</td>   <td>yes</td>                     <td>yes</td>                             <td>yes</td>                           <td>yes</td>                    <td>yes</td>                     </tr>
 <tr><td>1..1</td>   <td>no</td>                      <td>no</td>                              <td>no</td>                            <td>yes</td>                    <td>no</td>                      </tr>
 <tr><td>1..*</td>   <td>no</td>                      <td>no</td>                              <td>no</td>                            <td>yes</td>                    <td>yes</td>                     </tr>
</table>
<p>
When a profile is constraining another profile where there are more cardinality options (e.g. low is not just 0 or 1, and high is not just 1 or *), the same
principles still apply: the constraining profile can only allow what the base profile allows.
</p>
<p>
Note that though a profile can constrain an element from x..* to x..1, this doesn't make any difference to the 
representation in the JSON format - the element will still be represented in an array. As an example, take 
Patient.name which has a cardinality of 0..*. In an unprofiled Patient, this will be represented as:
</p>
<pre fragment="Patient" class="json">
{
  "resourceType" : "Patient",
	"name" : [{
	   "text" : "Peter James"
	}]
}
</pre>
<p>
Even if a profile is created on the resource that narrows the cardinality to 1..1, applications will still process
the resource without knowledge of the profile. For this reason the representation will still be the same. 
</p>


<a name="limitations"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.7</span> 使用局限 <a href="profiling.html#limitations" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>
<p>
    结构定义用于约束现有资源和数据类型时，有以下限制：
</p>
<ul>
 <li>
     适配定义不能违背在基本规范中建立的规则（如：上述的基数）</li>
 <li>
     适配定义不能为基本规范中定义的元素指定默认值或含义（请注意，数据类型和资源根本不会定义默认值），但可以为<a href="structuredefinition.html#logical">逻辑模型</a>定义默认值
    </li>
 <li>适配定义不能为基本规范中定义的元素提供更具体的名称，也不能添加新的元素</li>
 <li>
     必须保证即使不知道适配定义存在也能处理资源</li>
</ul>
<p>

    这样就意味着如果适配定义强制约束一个不能忽略的扩展，那么它还必须强制使用<a href="extensibility.html#modifierExtension ">限定扩展</a>（<a
        herf="domainresource-definitions.html#DomainResource.modifierExtension">域资源的modifierExtension元素</a>）。
    意即，必须在实例中显式的定义而不能隐式的进行适配定义。

</p>
<p>
As an example, if a profile wished to describe that a <a href="procedure.html">Procedure</a>
resource was being negated (e.g. asserting that it never happened), it could not simply say
in the profile itself that this is what the resource means; instead, the profile must
say that the resource must have an extension that represents this knowledge.
</p>
<p>
There is a facility to mark resources to indicate that they can only be safely understood by
a process that is aware of and understands a set of published rules. For more information,
see <a href="resource.html#implicitRules">Restricted Understanding of Resources</a>.
</p>


<a name="using"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.8</span> Using StructureDefinitions <a href="profiling.html#using" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>
<p>
A "constraint" StructureDefinition specifies a set of restrictions on the content of a FHIR resource or data type,
or an additional set of constraints on an existing profile.
A given structure definition is identified by its canonical URL, which SHOULD be the URL at which it
is published. The following kinds of statements can be made about how an element is used, using a
series of <a href="elementdefinition.html">Element Definitions</a>:
</p>
<ul>
 <li>Restricting the cardinality of the element; e.g. the base might allow 0..*, and a particular application might support 1..2</li>
 <li>Ruling out use of an element by setting its maximum cardinality to 0</li>
 <li>Restricting the contents of an element to a single fixed value</li>
 <li>Making additional constraints on the content of nested elements within the resource (expressed as XPath statements)</li>
 <li>Restricting the types for an element that allows multiple types</li>
 <li>Requiring a typed element or the target of a resource reference to conform to another structure profile (declared in the same profile, or elsewhere)</li>
 <li>Specifying a binding to a different terminology value set (see below)</li>
 <li>Providing refined definitions, comments/usage notes and examples for the elements defined in a Resource to reflect the usage of the element within the context of the Profile</li>
 <li>Providing more specific or additional mappings (e.g. to <a href="http://www.hl7.org/implement/standards/product_brief.cfm?product_id=185">HL7 v2 <img src="external.png" style="text-align: baseline"/></a> or <a href="https://www.hl7.org/implement/standards/product_brief.cfm?product_id=186">HL7 v3 <img src="external.png" style="text-align: baseline"/></a>) for the resource when used in a particular context</li>
 <li>Declaring that one or more elements in the structure must be 'supported' (see below)</li>
</ul>
<p>
Any changed definitions SHALL be restrictions that are consistent with the
rules defined in the resource in the FHIR Specification from which the profile is derived. Note that some of
these restrictions can be enforced by tooling (and are by the FHIR tooling), but
others (e.g. alignment of changes to descriptive text) cannot be automatically enforced.
</p>
<p>
Note that structure definitions cannot 'remove' mappings and constraints that are defined in the base structure,
but for purposes of clarity, they can refrain from repeating them.
</p>
<p>
A structure definition contains a linear list of <a href="elementdefinition.html">element definitions</a>. The inherent
nested structure of the elements is derived from the <i>path</i> value of each element.
For instance, a sequence of the element paths like this:
</p>
<ul>
 <li>Root</li>
 <li>Root.childA</li>
 <li>Root.childA.grandchild1</li>
 <li>Root.childB</li>
</ul>
<p>
defines the following structure:
</p>
<pre class="xml">
 &lt;Root&gt;
   &lt;childA&gt;
     &lt;grandChild1/&gt;
   &lt;/childA&gt;
   &lt;childB/&gt;
 &lt;/Root&gt;
</pre>
<p>
or its JSON equivalent. The structure is coherent - children are never
implied, and the path statements are always in order. The element list is
a linear list rather than being explicitly nested because element definitions
are frequently re-used in multiple places within a single definition, and this re-use
is easier with a flat structure.
</p>

<a name="snapshot"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.9</span> 结构定义资源（StructureDefinitions）与差异视图（differential） <a href="profiling.html#snapshot" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>

<p>
结构定义资源（StructureDefinitions）中可能包含差异视图（differential）和/或完整视图（snapshot）。
</p>
<p>
差异视图（differential）是对比其约束的基结构定义（baseDefinition，通常是FHIR原生资源类型或数据类型），描述二者不同之处。
例如，一个资源结构定义文件将一个元素的基数强制约束为1..1。此时，其差异视图中只会有这个元素，且元素的路径被设置为强制要求，同时描述了其基数的要求。
除了这些信息之外，其余的结构信息都是隐式的继承其基结构定义。这意味着差异视图可能十分精炼，它只提及已更改的元素，而不会列出完整的结构。包括根元素在内的其它元素均不会在精炼的差异视图中体现。
</p>
<p>
请注意，差异视图对可选元素处理有两种方案。一是不对其进行约束。这样可以提高与其它资源结构定义文件之间的兼容性，但这样会在具体实现时付出更多工作。二是将其基数约束为0（max cardinality=0），即，不允许元素出现。这使得实现更容易，但也降低了它的适合范围。
</p>
<p>
必须结合基结构定义才能“正确理解”差异视图,即:通过<code>$snapshot</code>操作方法计算出完整的资源结构。这种方式不仅计算量大，而且当基结构（通过URL获取）不可访问时，就无法获取完整的资源结构信息。因此，结构定义资源（StructureDefinitions）还能自带一个完整视图（snapshot），它不依赖于任何其它资源结构，是一个计算后得到的完整资源结构形式。FHIR项目这主流平台提供了一些利用差异视图生成简要说明的工具，这些工具生成的简要说明非常完整与详细，但它们<b>不支持</b>让映射（mapping ）和约束（constraint）失效，即基资源结构的映射和约束会强制继承在简要说明中。
</p>
<p>
结构定义资源（StructureDefinitions）可以包含差异视图（differential）和简要说明（snapshot）两种视图。这两种视图的用途偏向不同：差异视图适合在编写结构定义的过程中使用，而简要说明更多用于编辑工具实现。
在运行的系统中使用结构定义资源时，应始终带有简要说明。
</p>

<a name="slicing"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.10</span> 约束分割（Slicing） <a href="profiling.html#slicing" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>
<p>
对结构定义资源（StructureDefinitions）进行约束时，有一种常见情况：将某个可能多次重复出现的元素（比如一个基数为0……*的列表）分割为一系列的子列表，每个子列表对其包含元素的约束限制都不同，并且每个子列表都有自己的附加含义。在FHIR中，此操作称为对列表的“约束分割（Slicing）”。将列表“分割”为子列表后，为了有效地对列表中的每个元素施加个性化的约束，通常每个子列表中只包含一个元素。这样就可以把每个包含一个元素的列表，看成是一个具有个性意义的“约束片”。
</p>
<p>
下图的示例展示了分片约束的过程：
</p>
<img src="slicing.png" alt="Slicing diagram" width="520" height="353"/>
<p>

在本示例中，基资源结构是观测资源类型（<a href="observation.html">Observation</a> ），它定义了一个0……*的“component”元素来表示不同的观测指标。每个观测指标的编码和取值分别嵌套在“component”元素中的,code和value表示。这类观测资源的一个<a href="observation-example-bloodpressure.html">典型例子</a>是血压测量，血压有两指标：收缩压和舒张压。
</p>
<p>
上图展示了将“component”元素列表分割为收缩压和舒张压两个“约束片”的概念过程。（注：为了避免混乱，血压的资源结构的“名称（name）”属性仅数字编码显示，真实场景中应使用完整的可编码概念CodeableConcept）。
</p>
<p>
示例中血压的结构定义将“component”元素列表拆分为两个子列表，一个子列表包含一个收缩压元素，另一个子列表包含一个舒张元素。子列表中元素的编码属性值都固定为其对应的LOINC代码，并且将元素的值类型属性有固定为数量类型（Quantity）。这个过程被称为“约束分割（Slicing）”，收缩压和舒张压被称为“约束片”。
</p>
<p>
请注意，交换资源时，通过约束分割对基结构定义的进一步约束并不会更改所交换的序列化格式。这意味着在结构定义文件中定义的名称（本例中为“systolic”等）永远不会用于交换数据（实例数据消息体）。资源实例如下所示：
</p>
<pre>
 &lt;Observation&gt;
   ...
   &lt;component&gt;
     &lt;code {LOINC="8480-6"}/&gt;
     &lt;value ...&gt;
   &lt;/component&gt;
   &lt;component&gt;
     &lt;code {LOINC="8462-4"}/&gt;
     &lt;value ...&gt;
   &lt;/component&gt;
 &lt;/Observation&gt;
</pre>
<p>

系统需要用某些元素来区分不同的约束片，通过对元素的值的检测来定位约束。在本例中，为了确定“component”元素的第一个约束片与收缩压相对应，就通过检测资源中的“code”元素的来分辨。此时，code元素就称为“辨别字段”。
</p>

<a name="discriminator"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.11</span> 辨别字段（Discriminator） <a href="profiling.html#discriminator" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>
<p>

在一般情况下，系统可以通过检测“约束片”中元素的具体内容是否满足约束规则的要求来判定与具体项目的对应关系。但这要求处理器能够检查应用于约束片中的所有规则，并以深度优先的方式进行推测。这两项要求对于运行系统来说都相当的困难，对于在运行时生成代码的系统（例如根据结构定义自动计算的软件）来说就更是难上加难了。因此，FHIR提供一个更好的区分约束片的方法：被约束分割的元素可以指定一个或一组字段，用作区分约束片的“辨别字段”。
</p>
<p>
一旦指定了辨别字段，辨别字段中指定的元素的组合值将是唯一的，即在每个可能的约束片这些值的组合都会不同。这样应用程序可以容易地确定列表中的项目对应哪个约束片，甚至可以在运行时生成的代码中判定，例如使用switch/case语句。
</p>
<p>
当约束结构指定一个或多个辨别字段时，<b>必须</b>确保它在每个约束片中的可能值不同且不重叠，以便易于区分约束片。
</p>
<p>

每个辨别字段都是由一个类型和一个<a href="fhirpath.html">FHIRPath</a>表达式组成的一对值。FHIRPath：如何找到辨别字段。类型：如何处理字段，辨别字段有五种不同的处理类型：
</p>
<table class="codes">
<tr><td>类型</td><td>如何处理</td></tr>
 <tr><td><a href="#value">value</a></td><td>
 通过基本数据类型的元素值辨别。约束片中指定一个简单类型的元素作为辨别字段，此元素在每个约束片中的值都不同。
</td></tr>

 <tr><td><a href="#pattern">pattern</a></td>
 <td>
 通过复杂数据类型的元素值辨别。约束片中指定一个复杂类型的元素作为辨别字段，此元素在每个约束片中的值都不同，可以通过<a href="elementdefinition-definitions.html#ElementDefinition.pattern_x_">ElementDefinition.pattern[x]</a>的定义来测试。</td></tr>
 
  <tr><td><a href="#exists">exists</a></td><td>
 通过是否存某个元素辨别。约束片中指定一个元素作为辨别字段，在资源实例中可能存在此元素，也可能缺失此元素。
</td></tr>

 <tr><td><a href="#type">type</a></td>
 <td>通过元素的类型辨别。约束片中指定多态类型元素[x]作为辨别字段，此元素在每个约束片中的采用的类型都不同。
 </td></tr>
 <tr><td><a href="#profile">profile</a></td>
 <td>
 通过元素的结构定义辨别。约束片中指定一个元素作为辨别字段，通过测试此元素的实例值是否符合指定的结构定义来分区约束片。此时，约束片的路径值（elementDefinition.slicing.discriminator.path）对应元素的实例值的数据类型应该是StructureDefinition或ImplementationGuide。注意，如果约束片的路径值为resolve()函数，即，elementDefinition.slicing.discriminator.path设置为resolve()，就应该使用约束片的引用的目标结构定义（elementDefinition.type.targetProfile）来测试元素的符合性。在这种情况下，要求验证可能符合的结构定义来辨别约束片。

 </td></tr>
</table>

<p>
辨别字段上应用FHIRPath语句只能受限使用，此时只使用以下语法和函数：
</p>
<ul>
 <li>选择元素的语句，即：仅使用“.”来定位元素的路径，而不使用带“()”函数，比如 <code>component.value</code>。</li>
 <li>选择扩展的函数，即：<code>extension(url)</code> 。用于定位某个扩展。</li>
 <li>表决函数，即： <code>resolve()</code>，它允许约束分割跨越资源边界</li>
 <li>选择类型的函数，即： <code>ofType()</code> 用于选择多态类型元素的具体类型</li>
</ul>
<p>
请参阅<a href="fhirpath.html#simple">FHIRPath受限子集</a>.
</p>
<p>不同类型的辨别字段：进一步说明：
</p>
<table class="codes">
 <tr><td>value</td><td>
 这是辨别字段最常用的一种类型：根据元素的值进行辨别。此时作为辨别字段的元素的数据类型通常为诸如<code>code</code>, <code>uri</code>等的基本数据类型。例如：对<code>Patient.telecom.system</code>进行约束分割，由于此元素值可以phone, email 等，所以可以通过电话、电子邮件等联系方式来辨别不同的约束。
 </td></tr>
 <tr><td>pattern</td><td>
   常用于通过<code>CodeableConcept</code>类型的元素值辨别：将辨别字段与<code>element.patternCodeableConcept</code>中的一组预期编码进行匹配。虽然可以资源实例数据可能出现其它编码，但这与约束片的匹配过程无关。典型示例：对<code>Observation.code</code>的值进行约束分割，将LOINC编码为1234-5、4235-8等分割为一个约束片。
 </td></tr>
 <tr><td>exists</td><td>
   由于它只能实现“是”和“否”两种情况的约束片，所以单独使用它的时候不多，常常作用辅助辨别字段与其他辨别字段结合在一起用使用，以达到更精准的分割标准。多用于对复杂的主干元素的分割。典型示例：将pattern类型的Observation.code辨别字段和exists类型的Observation.component辨别字段结合使用。
 </td></tr>
 <tr><td>type</td><td>
  基于元素的数据类型来匹配约束片。虽然它可以基于多态类型元素（如Observation.value[x]）分割约束片，但它更常用于基于引用的资源类型的分割，以实现根据不同的资源类型应用不同的资源结构定义文件。
  
  典型示例：通过对<code>List.entry.item.resolve()</code>进行type类型的约束分割，将List.entry.item分割为Patient类型和RelatedPerson类型的约束片。
 </td></tr>
 <tr><td>profile</td><td>
   通过对辨别字段的检测，判断其是否符合指定的资源结构定义文件，以匹配对应的约束片。它的功能最强大，因为profile支持FHIR标准符合性的全部特性，但它也是最难实现的，并且处理量巨大（是其它类型处理量的1000倍以上）。当只能使用它才能实现需求时，才采用此模式。
   典型示例：通过对<code>Composition.section.entry()</code> 的约束分割来定义CDA的章节，每个章节分割为一个约束片，如当前临床状况、历史医疗事件等章节。
 </td></tr>
</table>

<p>

每个约束片的辨别字段必须使用<a href="elementdefinition.html">元素定义（ElementDefinition）</a>定义其中的元素，以确保通过根据辨别字段的类型指定合适当的值来明确区分约束片。如果辨别字段的类型为value或pattern，则约束片的元素定义必须符合下列要求之一：
</p>
<ul>
 <li>使用<a href="elementdefinition-definitions.html#ElementDefinition.fixed_x_">ElementDefinition.fixed[x]</a> 指定固定值；
 </li>
 <li>使用<a href="elementdefinition-definitions.html#ElementDefinition.pattern_x_">ElementDefinition.pattern[x]</a>指定元素类型；</li>
 <li>
 如果元素具有术语绑定，则需要使用<a href="valueset.html#required">值域集</a>进行绑定，该值域集枚举了所有可能使用的编码列表（在“外部定义”）。
</li>
</ul>
<p>
约束片的唯一性是靠多个辨别字段的组合值来确定的。
例如，对一组引用其它资源的节点进行约束分割，每个约束片都可以指定不同资源中的一个元素作为辨别字段，只要这些元素在所有约束片中都是可以区分的。
</p>
<p>

虽然没有强制要求结构定义必须为约束片指定辨别字段，但仅通过描述内容来处理非常难以处理，因此不鼓励这样做。
</p>
<p>

在结构定义中对条目元素进行约束分割后产生的多个约束片可共同构成“约束片组”，组内约束片元素的路径（<i>path</i>）相同，但名称（<i>sliceName</i>）不同。即：
</p>
<ol>

	<li><b>Initiated by a "slicing entry"</b> That is, the first
		<i>element</i> in a slice group must contain a
		<i>slicing</i> property that defines the
		<i>discriminator</i> for all members of the group.  It also contains the unconstrained definition of the element that is sliced, potentially including children of the unconstrained element, if there are any</li>

	<li><b>Mutually exclusive</b>. This means that each
		<i>element</i> in a slice group SHALL describe a
		distinct set of  values for the group's
		<i>discriminators</i>.  Because of this constraint, an
	        element in a resource <b>instance</b> will never match more
		than one <i>element</i> in a given slice group. If no discriminators are named,
    it SHOULD still be possible to differentiate the slices based
    on their properties, though it may be substantially harder to
    do so.</li>

	<li><b>Serialized as a group</b>. The entries in a slice
		group must be <b>adjacent</b> in a serialized structure definition,
		<b>or</b>, if there are any intervening elements, those
		elements must be "compatible with" the group. Concretely, this
		means that any intervening elements must have a
		<i>path</i> that starts with the slice group's
		<i>path</i>.  For example, an <i>element</i> with a
		<i>path</i> of <i>Observation.name.extension</i>
		would be compatible with (and thus, would not "break up") a
		slice group whose path was <i>Observation.name</i> </li>
</ol>
<p>
Some examples of discriminators:
</p>
<table class="grid">
 <tr>  <td><b>Context</b></td> <td><b>Discriminator Type</b></td> <td><b>Discriminator Path</b></td> <td><b>Interpretation</b></td> </tr>
 <tr>  <td>List.entry</td> <td>value</td> <td>item.resolve().name</td> 
 
 <td>
 通过解析目标资源的name元素来区分条目。目标资源可能是一个Organization资源，这可以通过资源结构定义文件中提供的信息来确定。
 </td> </tr>
 <tr>  <td>List.entry</td> <td>type</td> <td>item.resolve()</td> <td>

 通过解析目标资源的类型来区分条目。
 </td> </tr>
 <tr>  <td>List.entry</td> <td>profile</td> <td>item.resolve()</td> <td>

 通过解析目标资源的资源结构定义文件中的标签（tag）来区分条目。标签由资源结构定义文件中的结构定义指定。
 
 </td> </tr>
 <tr>  <td>List.entry</td> <td>value</td> <td>item.extension("http://acme.org/extensions/test").value</td>
 <td>
 通过解析目标资源的特定扩展元素的值来区分条目。扩展元素的定义由括号中的URL定义。
 </td> </tr>
 <tr>  <td>List.entry.extension</td> <td>value</td> <td>url</td> 
  通过解析目标资源的特定扩展元素的值来区分条目。
 <td>
 Extensions are differentiated by the value of their url property (usually how extensions are sliced)
 扩展的区别在于其url属性的值（通常是扩展的切片方式）
 </td> </tr>
 <tr>  <td>List.entry</td> <td>type, value</td> <td>item.resolve(), item.resolve().value</td> <td>Extensions are differentiated by the combination of the type of the referenced resource, and, if it has one, the code element of that resource. This would be
   appropriate for where a List might be composed of a Condition, and set of observations, each differentiated by its name - the condition has no name, so that is evaluated as a null in the discriminator set</td> </tr>
 <tr>  <td>Observation.value[x]</td> <td>type</td> <td>$this</td> <td>Different constraints (e.g. "must support", usage notes, vocabulary bindings, etc.) are asserted for different supported types for the multi-typed element Observation.value[x]</td> </tr>
</table>
<p>
Note that discriminator types of type and profile can also be used where a repeating element contains a resource directly (e.g.
<a href="domainresource-definitions.html#DomainResource.contained">DomainResource.contained</a>, <a href="bundle-definitions.html#Bundle.entry">Bundle.entry</a>, <a href="parameters-definitions.html#Parameters.parameter.resource">Parameters.parameter.resource</a>).
</p>
<p>
The <a href="profiling-examples.html">examples of slicing and discriminators</a> show exactly how this and other typical uses of slicing are represented in profiles.
</p>
<p>
Note that extensions are always sliced by the <code>url</code> element, though they may be resliced on additional elements where required.
</p>

<a name="slice-cardinality"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.12</span> Slice Cardinality <a href="profiling.html#slice-cardinality" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>
<p>
When an element of a fixed cardinality m..n is sliced, the following rules apply:
</p>
<ul>
 <li>Each slice cannot have a greater cardinality than the maximum number of slices allowed</li>
 <li>The sum of the maximum cardinalities can be larger than <code>n</code></li>
 <li>The sum of the minimum cardinalities must be less or equal to <code>n</code></li>
 <li>Each individual slice can have a minimum cardinality of 0 (less than <code>m</code> - the only situation where this is allowed), but the total number of elements in the instance must still be greater or equal to <code>m</code></li>
</ul>


<a name="default-slice"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.13</span> 默认约束片 <a href="profiling.html#default-slice" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>
<p>

有一个特殊的约束片，称为默认约束片。它用于在资源结构定义文件中排除一组约束片，仅将相关规则应用默认约束片之外的其它内容。这些规则包括：
</p>
<ul>
 <li>
 由于<code>@default</code>是为约束片保留的名称，所以“@default”不能在任何其他上下文中使用，它是默认约束片的唯一标识。
 </li>
 <li>
 仅当约束分割规则为关闭（elementDefinition.slicing.rules = closed），才允许使用默认约束片。
 </li>
 <li>
 默认约束片不能将辨别字段元素的值固定</li>
 <li>
 可以在从属的资源结构定义文件中将默认约束片进行再分割。
 </li>
</ul>
<p>
这种场景需求可能会用到默认约束片：需要提供一个或多个证件，且必须提供身份证（为了减少交换数据量，不提供身份证件类型的代码）。只要没指定采用哪个证件类型的标准，就是默认的为身份证。如果指定了证件标准（如，identifier.system=GN n37.7 ，护照类型代码），则要求提供具体哪种类型（如，Identifier.type=11，外交护照）。 
</p>
<p>
利用默认约束片实现以上场景的方法为：对一个标识元素进行约束分割，并将identifier.system设置为辨别字段。

添加一个名为“@default”的约束片作为默认约束片，将其基数设置为1…1，并禁用其<code>type</code>元素（因为默认会使用某些已知标识符类型，如身份证）。
再设置其它可能的约束片的<code>type</code>元素（如果有，比如针对护照类型的约束片，其将identifier.system值固定为GN n37.7，其tpye基数设置为1…*）。

此时，辨别字段的约束规则对默认约束片就不再不适用，仅对其它约束片生效。即当不提供identifier.system值或没有任何一个约束片的identifier.system值能匹配时，默认使用默认约束片。
</p>

<a name="reslicing"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.14</span> Re-profiling and Re-slicing <a href="profiling.html#reslicing" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>
<p>
Profiles can be based on other profiles and can apply further constraints to those already
specified. This is a useful technique, but implementers should be wary of over-use - humans
have trouble understanding the implications of deep stacks of constraining profiles.
</p>
<p>
When a profile constrains another profile, it can make additional constraints, including
extending the discriminator, adding new slices (if the slices are not already closed), and
slicing inside the existing slices.
</p>
<p>
The rules for constraining ElementDefinition.slicing are as follows:
</p>
<ul>
 <li><code>ElementDefinition.slicing.rule</code> can be constrained from <code>open</code> to <code>closed</code></li>
 <li><code>ElementDefinition.slicing.ordered</code> can be constrained from <code>false</code> to <code>true</code></li>
 <li>If a discriminator for an element is declared in a parent profile, child profiles referencing that element:
   <ul>
     <li>SHALL include all the same discriminators</li>
     <li>MAY add additional discriminators</li>
    </ul>
  </li>
</ul>

<p>
It's sometimes necessary to slice data that has already been sliced in the base
profile - that is, create new slices within the existing slices.  This is called
"Re-slicing".  The rules for re-slicing are as follows:
</p>

<p>
When you slice, you define a name for each new slice. The name has to be unique across the set of slices in the profile. So if profile A defines an element X with cardinality 0..*, and profile B is derived from profile A, then profile B can either:
</p>
<ol>
  <li>make a constraint on X with no ElementDefinition.sliceName - in which case the profile is adding constraints to all slices of X; or </li>
  <li>make a constraint on X with an ElementDefinition.sliceName - in which case the profile is describing a specific slice on X, and the constraints only apply to that slice; or </li>
  <li>it can do both</li>
</ol>
<p>
Then, profile C derives from profile B. Profile C can do the following:
</p>
<ol>
  <li>make a constraint on X with no ElementDefinition.sliceName - in which case the profile is constraining all slices of X; or </li>
  <li>make a constraint on X with a different ElementDefinition.sliceName from that used in profile B - in which case the profile is describing a specific new slice on X, and the constraints only apply to that slice; or </li>
  <li>make a constraint on X with the same ElementDefinition.sliceName as that used in profile B - in which case the profile is making new constraints on the slice defined in profile B; or </li>
  <li>some combination of the above options</li>
</ol>
<p>
Note that it is possible for Profile C to make rules that are incompatible with profile B, in which case there is no set of instances that can be valid against profile C
</p>
<p>
In addition to the above, there are times when Profile C will need to further slice a slice defined in B.  In this case, there's a need to reference both the ElementDefinition.sliceName of the original
slice from Profile B as well as to define an ElementDefinition.sliceName for the slice defined within Profile C.  This is done by separating the names using "/".  For example, if Profile B defines the slice "example", and
profile C defines the slice "example/example1", then this is deemed to be "example1" slice of the example slice.  This process can continue indefinitely by separating each layer of slicing names with the "/" character.
This pattern applies to @default too: @default/@default.
</p>

<a name="extensions"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.15</span> Extension Definitions <a href="profiling.html#extensions" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>
<p>
An extension definition defines the URL that identifies the extension
and is used to refer to the extension definition when it is used
in a resource.
</p>
<p>
The extension definition also defines the context where the extension can be used (usually
a particular path or a data type) and then defines the extension element using the same details used to
profile the structural elements that are part of resources. This means that a single extension
can be defined once and used on different resources and/or datatypes, e.g. one would only have to
define an extension for "hair color" once, and then specify that it can be used on both Patient and Practitioner.
</p>
<p>
For further discussion of defining and using extensions, along with some examples,
see <a href="extensibility.html">Extensibility</a>.
</p>

<a name="using-extensions"></a>
<h4 class="self-link-parent"><span class="sectioncount">5.1.0.15.1</span> Using Extensions in Profiles <a href="profiling.html#using-extensions" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h4>
<p>
Once defined, an extension can be used in an instance of a resource
without any Profile declaring that it can, should or must be, but
Profiles can be used to describe how an extension is used.
</p>
<p>
To prescribe the use of an extension in an instance, the extension list
on the resource needs to be sliced. This is shown in <a href="extensibility-examples.html#sliceextensions">the extensibility
examples</a></p>
<p>
Note that the minimum cardinality of an extension SHALL be a valid restriction
on the minimum cardinality in the definition of the extension. If the minimum
cardinality of the extension is 1 when it is defined, it can only be mandatory
when it is added to a profile. This is not recommended - the minimum cardinality
of an extension should usually be 0.
</p>


<a name="binding"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.16</span> Binding Definitions <a href="profiling.html#binding" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>

<p>
Coded elements have bindings that link from the element to a definition of the
set of possible codes that the element may contain. The binding identifies the
definition of the set of possible codes and controls how tightly the set of the possible codes is interpreted.
</p>
<p>
The set of possible codes is either a formal reference to a <a href="valueset.html">ValueSet</a>
resource, which may be version specific, or a general reference to some web content that defines a set of
codes. The second is most appropriate where a set of values is defined by
some external standard (such as mime types). Alternatively, where the binding
is incomplete (e.g. under development) just a text description of the
possible codes can be provided.
</p>
<p>
Bindings have a property that defines the degree of flexibility associated
with the use of the codes in the value set. See <a href="terminologies.html#strength">Binding Strength</a> for further information.
</p>

<a name="tx"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.17</span> Mixing Custom and Standard Terminologies <a href="profiling.html#tx" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>
<p>
<a href="codesystem.html">CodeSystem</a> resources can be used to carry definitions of local
codes (<a href="codesystem-example.html">Example</a>) and <a href="valueset.html">ValueSets</a>
can mix a combination of local codes and standard codes (e.g. LOINC, SNOMED), or just
to choose a particular set of standard codes (examples: LOINC, SNOMED, RxNorm).
Profiles can bind to these value sets instead of the ones defined in the base
specification, following these rules:
</p>
<table class="grid">
 <tr> <td><b><a href="terminologies.html#binding">Binding Strength</a> in base specification</b></td> <td><b>Customization Rules in Profiles</b></td> </tr>
 <tr> <td>required</td> <td>The value set can only contain codes contained in the value set specified by the FHIR specification</td> </tr>
 <tr> <td>extensible</td>  <td>The value set can contain codes not found in the base value set. These additional codes SHOULD NOT have the same meaning as existing codes in the base value set</td> </tr>
 <tr> <td>preferred or example</td>  <td>The value set can contain whatever is appropriate for local use</td> </tr>
</table>
<p>
Note that local codes are not as interoperable as standard published code systems (e.g. LOINC, SNOMED CT), so it is preferable to use standard code systems.
</p>

<a name="binding-strength"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.18</span> Changing Binding Strength in Profiles <a href="profiling.html#binding-strength" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>

<p>
A profile
can change the terminology binding of an element - both strength and value set - within the limits of the base structure
it is constraining. This table summarizes the changes that can be made to the binding strength:
</p>
<table class="grid">
 <tr><td>derived (across)<br/>base (down)</td>  <td>required</td>      <td>extensible</td>              <td>preferred</td>      <td>example</td>       </tr>
 <tr><td>required</td>               <td>yes</td>                      <td>no</td>                               <td>no</td>        <td>no</td>         </tr>
 <tr><td>extensible</td>             <td>yes</td>                      <td>yes</td>                              <td>no</td>        <td>no</td>         </tr>
 <tr><td>preferred</td>              <td>yes</td>                      <td>yes</td>                              <td>yes</td>       <td>no</td>         </tr>
 <tr><td>example</td>                <td>yes</td>                      <td>yes</td>                              <td>yes</td>       <td>yes</td>            </tr>
</table>
<p>
Note that a constraining profile may leave the binding strength the same and change the value set instead. Whatever the
constraining profile does, it cannot make codes valid that are invalid in the base profile.
</p>

<a name="mustSupport"></a>
<a name="mustsupport"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.19</span> Must Support <a href="profiling.html#mustsupport" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>
<p>
One of the properties that can be declared on profiles but not on resource or data type definitions is 'mustSupport'.
This is a boolean property.  If true, it means that systems claiming to conform to a given profile must "support" the element.
This is distinct from cardinality.  It is possible to have an element with a minimum cardinality of "0", but still expect systems
to support the element.
</p>
<p>
The meaning of "support" is not defined by the base FHIR specification, but can be set to
true in a profile. When a profile does this, it SHALL also make clear
exactly what kind of "support" is required. Examples include:
</p>
<ul>
  <li>The system must be able to store and retrieve the element</li>
  <li>The system must display the element to the user and/or allow the user to capture the element via the UI</li>
  <li>The element must appear in an output report</li>
  <li>The element must be taken into account when performing decision support, calculations or other processing</li>
  <li>etc.</li>
</ul>
<p>
The specific meaning of "Must Support" for the purposes of a profile SHALL be described in the <code>ElementDefinition.definition</code>,
the general <code>StructureDefinition.description</code> or in other documentation for the implementation guide that includes the profile.
</p>
<p>
If creating a profile based on another profile, Must Support can be changed from false to true, but cannot be changed from true to false.
Note that an element that has the property IsModifier is not necessarily a "key" element (e.g. one of
the important elements to make use of the resource), nor is it automatically mustSupport - however both
of these things are more likely to be true for IsModifier elements than for other elements.
</p>

<a name="search"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.20</span> Search Criteria <a href="profiling.html#search" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>
<p>
Implementations can define search criteria in addition to those defined in the specification itself.
Search criteria fall into one of four categories:
</p>
<ol>
  <li>Enabling search on core elements that don't have standard search criteria defined (e.g. searching Observation by normal range)</li>
  <li>Enabling search on elements that already have standard search criteria defined, but with custom matching rules; e.g. a sounds-like search on Practitioner name</li>
  <li>Enabling search on an extension</li>
  <li>Enabling search that doesn't correspond to a single element but rather a combination of elements or computation on an element; e.g. searching for patients by age</li>
</ol>
<p>
Additional Search Parameters can be defined using the <a href="searchparameter.html">SearchParameter</a> resource.
</p>

<a name="presentation"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.21</span> Presenting Profiles <a href="profiling.html#presentation" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>

<p>
When this specification describes a profile, the profile is presented in 5 different forms:
</p>
<table class="grid">
 <tr><td>Text Summary</td><td>This presents a short summary human readable summary of the profile - a combination of the author's summary, and some automatically generated summary content</td></tr>
 <tr><td>Differential Table</td><td>This is a view of the differential statement (<a href="#snapshot">see above</a>). For context, additional information not in the differential is also shown partially transparent</td></tr>
 <tr><td>Snapshot Table</td><td>This is a view of the snapshot produced by the profile (<a href="#snapshot">see above</a>). The information is a comprehensive view of what the profile means</td></tr>
 <tr><td>XML Template</td><td>An example of what the profile looks like in XML format</td></tr>
 <tr><td>JSON Template</td><td>An example of what the profile looks like in JSON format</td></tr>
</table>

<a name="mixing"></a>
<h3 class="self-link-parent"><span class="sectioncount">5.1.0.22</span> Supporting Multiple Profiles <a href="profiling.html#mixing" title="此处链接地址" class="self-link"><svg viewBox="0 0 1792 1792" width="20" class="self-link" height="20"><path d="M1520 1216q0-40-28-68l-208-208q-28-28-68-28-42 0-72 32 3 3 19 18.5t21.5 21.5 15 19 13 25.5 3.5 27.5q0 40-28 68t-68 28q-15 0-27.5-3.5t-25.5-13-19-15-21.5-21.5-18.5-19q-33 31-33 73 0 40 28 68l206 207q27 27 68 27 40 0 68-26l147-146q28-28 28-67zm-703-705q0-40-28-68l-206-207q-28-28-68-28-39 0-68 27l-147 146q-28 28-28 67 0 40 28 68l208 208q27 27 68 27 42 0 72-31-3-3-19-18.5t-21.5-21.5-15-19-13-25.5-3.5-27.5q0-40 28-68t68-28q15 0 27.5 3.5t25.5 13 19 15 21.5 21.5 18.5 19q33-31 33-73zm895 705q0 120-85 203l-147 146q-83 83-203 83-121 0-204-85l-206-207q-83-83-83-203 0-123 88-209l-88-88q-86 88-208 88-120 0-204-84l-208-208q-84-84-84-204t85-203l147-146q83-83 203-83 121 0 204 85l206 207q83 83 83 203 0 123-88 209l88 88q86-88 208-88 120 0 204 84l208 208q84 84 84 204z" fill="navy"></path></svg></a></h3>

<p>
Applications may be required to support more than one profile at a time.
A typical example might be an EHR application that is required to support
a general purpose data sharing profile (such as <a href="http://hl7.org/fhir/us/daf">DAF <img src="external.png" style="text-align: baseline"/></a>),
and also must support specific profiles for decision support using the same
interface.
</p>
<p>
The impact of supporting two sets of profiles depends on whether resources
are being created or consumed. When an application is creating content, it
must create content that conforms to both sets of profiles - that is, the
intersection of the profiles. When an application is consuming information,
then it must be able to consume content that conforms to either set of
profiles - that is, the union of the profiles.
</p>
<p>
Since applications generally consume and produce resources at the same time,
conforming to more than one profile might not be possible, unless the profiles
are designed to make statements at different levels - and the case above
is one such case, where one profile is focused on data access, provenance,
and availability, the other profile is focused on clinical content.
</p>
<p>
Accordingly, profiles can relate to each other in four different ways.
Each profile can be thought of in terms of the set of instances that conform to the profile:
</p>
<ol>
 <li>Non-overlapping: there no instances that conform to profiles A &amp; B (technically, the intersection of profiles A &amp; B is an empty set)</li>
 <li>Partly overlapping: some instances conform to both A &amp; B, but others only conform to A or B</li>
 <li>One set contained in the other: all resources that conform to A conform to B, but only some of the ones that conform to B conform to A (or vice versa)</li>
 <li>Identical sets: the set of resources that conform to A is the same as the set of resource that conform to B and the set of resources that don't conform to A is the same as the set of resources that don't conform to B</li>
</ol>
<p>
Profiles can be compared to determine their compatibility.
One such comparison can be found (Todo: bring this into the build)
between <a href="http://hl7.org/fhir/us/daf">DAF <img src="external.png" style="text-align: baseline"/></a> and <a href="http://hl7.org/fhir/us/qicore">QICore <img src="external.png" style="text-align: baseline"/></a>.
Note that this comparison is generated by tooling under ongoing development, and is purely draft
content to demonstrate the idea of profile comparison.
</p>

</div>


				</div>  <!-- /inner-wrapper -->
            </div>  <!-- /row -->
        </div>  <!-- /container -->
        
    </div>  <!-- /segment-content -->


        <div id="segment-footer" class="segment"></div>  <!-- /segment-footer -->
  <!-- disqus thread -->
  <!-- disqus -->
  <!-- end disqus -->        
	
	<div id="segment-post-footer" class="segment hidden">  <!-- segment-post-footer -->
		<div class="container">  <!-- container -->
		</div>  <!-- /container -->
	</div>  <!-- /segment-post-footer -->
    
      <!-- JS and analytics only. -->
      <!-- Bootstrap core JavaScript
================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
<script src="./assets/js/jquery.js"> </script>     <!-- note keep space here, otherwise it will be transformed to empty tag -> fails -->
<script src="./dist/js/bootstrap.min.js"> </script>
<script src="./assets/js/respond.min.js"> </script>

<script src="./assets/js/fhir.js"> </script>

  <!-- Analytics Below
================================================== -->
        <script src="./assets/js/template-web.js"></script>
        <script src="./assets/js/nav.js"></script>
        <script>
            var _hmt = _hmt || [];
            (function () {
                var hm = document.createElement("script");
                hm.src = "https://hm.baidu.com/hm.js?351f802705b09ff497ed83d498777ee1";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
            })();
        </script>
</body>
</html>